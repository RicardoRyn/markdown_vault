# ç®€ä»‹

ç¨‹åºå°†ä¼šç”Ÿæˆä¸€ä¸ª 1 åˆ° 100 ä¹‹é—´çš„éšæœºæ•´æ•°ã€‚
ç„¶åŽæç¤ºçŽ©å®¶è¾“å…¥ä¸€ä¸ªçŒœæµ‹å€¼ã€‚
è¾“å…¥åŽï¼Œç¨‹åºä¼šæŒ‡ç¤ºè¯¥çŒœæµ‹æ˜¯å¤ªä½Žè¿˜æ˜¯å¤ªé«˜ã€‚
å¦‚æžœçŒœå¯¹äº†ï¼Œæ¸¸æˆä¼šæ‰“å°ç¥è´ºä¿¡æ¯å¹¶é€€å‡ºã€‚

# å¤„ç†ä¸€æ¬¡çŒœæµ‹

ä»£ç ï¼š

```rust
use std::io;

fn main() {
    println!("Guess the number!");

    println!("Please input your guess.");

    let mut guess = String::new();

    io::stdin()
        .read_line(&mut guess)
        .expect("Failed to read line");

    println!("You guessed: {guess}");
}
```

ä¸ºäº†èŽ·å–ç”¨æˆ·è¾“å…¥å¹¶æ‰“å°ç»“æžœä½œä¸ºè¾“å‡ºï¼Œæˆ‘ä»¬éœ€è¦å°† io è¾“å…¥/è¾“å‡ºåº“å¼•å…¥å½“å‰ä½œç”¨åŸŸã€‚
`io` åº“æ¥è‡ªäºŽæ ‡å‡†åº“ï¼Œä¹Ÿè¢«ç§°ä¸º `std`ï¼š

```rust
use std::io
```

> é»˜è®¤æƒ…å†µä¸‹ï¼ŒRust è®¾å®šäº†è‹¥å¹²ä¸ªä¼šè‡ªåŠ¨å¯¼å…¥åˆ°æ¯ä¸ªç¨‹åº**ä½œç”¨åŸŸ**ä¸­çš„æ ‡å‡†åº“å†…å®¹ï¼Œè¿™ç»„å†…å®¹è¢«ç§°ä¸º **é¢„å¯¼å…¥ï¼ˆpreludeï¼‰ å†…å®¹**ã€‚
> å¦‚æžœä½ éœ€è¦çš„ç±»åž‹ä¸åœ¨é¢„å¯¼å…¥å†…å®¹ä¸­ï¼Œå°±å¿…é¡»ä½¿ç”¨ `use` è¯­å¥æ˜¾å¼åœ°å°†å…¶å¼•å…¥ä½œç”¨åŸŸã€‚

æŽ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ª å˜é‡ï¼ˆvariableï¼‰æ¥å‚¨å­˜ç”¨æˆ·è¾“å…¥ï¼Œåƒè¿™æ ·ï¼š

```rust
let mut guess = String::new();
```

> ç­‰å·çš„å³è¾¹æ˜¯ guess æ‰€ç»‘å®šçš„å€¼ï¼Œå®ƒæ˜¯ `String::new` çš„ç»“æžœï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›žä¸€ä¸ª `String` çš„æ–°å®žä¾‹ã€‚
> `String` æ˜¯ä¸€ä¸ªæ ‡å‡†åº“æä¾›çš„**å­—ç¬¦ä¸²ç±»åž‹**ï¼Œå®ƒæ˜¯ UTF-8 ç¼–ç çš„å¯å¢žé•¿æ–‡æœ¬å—ã€‚
> 
> `::` è¯­æ³•è¡¨æ˜Ž `new` æ˜¯ `String` ç±»åž‹çš„ä¸€ä¸ª **å…³è”å‡½æ•°ï¼ˆassociated functionï¼‰**ã€‚
> **å…³è”å‡½æ•°**æ˜¯é’ˆå¯¹æŸä¸ª**ç±»åž‹**å®žçŽ°çš„å‡½æ•°ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­çš„**ç±»åž‹**æ˜¯ `String`ã€‚

æ€»çš„æ¥è¯´ï¼Œ`let mut guess = String::new();` è¿™ä¸€è¡Œåˆ›å»ºäº†ä¸€ä¸ªå¯å˜å˜é‡ï¼Œå½“å‰å®ƒç»‘å®šåˆ°ä¸€ä¸ªæ–°çš„ `String` ç©ºå®žä¾‹ä¸Šã€‚

è°ƒç”¨ `io` åº“ä¸­çš„å‡½æ•° `stdin`ï¼Œç”¨æ¥å¤„ç†ç”¨æˆ·è¾“å…¥:

```rust
io::stdin()
	.read_line(&mut guess)
```

ç”¨`std::io::stdin`å‡½æ•°ï¼Œè¿”å›žä¸€ä¸ª`Stdin`å®žä¾‹ï¼ˆè¿™æ˜¯ä¸€ç§ä»£è¡¨**ç»ˆç«¯æ ‡å‡†è¾“å…¥å¥æŸ„**çš„ç±»åž‹ï¼‰ã€‚

`.read_line(&mut guess)` è°ƒç”¨äº†æ ‡å‡†è¾“å…¥å¥æŸ„ä¸Šçš„ `read_line` æ–¹æ³•ï¼Œä»¥èŽ·å–ç”¨æˆ·è¾“å…¥ã€‚
è¿™é‡Œå°† `&mut guess` ä½œä¸ºå‚æ•°ä¼ é€’ç»™ `read_line` å‡½æ•°ï¼Œè®©å…¶å°†ç”¨æˆ·è¾“å…¥å‚¨å­˜åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚

> `read_line` å‡½æ•°çš„å·¥ä½œæ˜¯ï¼Œæ— è®ºç”¨æˆ·åœ¨æ ‡å‡†è¾“å…¥ä¸­é”®å…¥ä»€ä¹ˆå†…å®¹ï¼Œéƒ½å°†å…¶è¿½åŠ ï¼ˆä¸ä¼šè¦†ç›–å…¶åŽŸæœ‰å†…å®¹ï¼‰åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œ**å› æ­¤å®ƒéœ€è¦å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°**ã€‚
> è¿™ä¸ªå­—ç¬¦ä¸²å‚æ•°åº”è¯¥æ˜¯**å¯å˜çš„**ï¼Œä»¥ä¾¿ `read_line` å°†ç”¨æˆ·è¾“å…¥é™„åŠ ä¸ŠåŽ»ã€‚
> 
> `&` è¡¨ç¤ºè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª **å¼•ç”¨ï¼ˆreferenceï¼‰**ï¼Œå®ƒå…è®¸å¤šå¤„ä»£ç è®¿é—®åŒä¸€å¤„æ•°æ®ï¼Œè€Œæ— éœ€åœ¨å†…å­˜ä¸­å¤šæ¬¡æ‹·è´ã€‚

`read_line` ä¼šå°†**ç”¨æˆ·è¾“å…¥**é™„åŠ åˆ°ä¼ é€’ç»™å®ƒçš„**å­—ç¬¦ä¸²**ä¸­ï¼Œä½†å®ƒä¹Ÿä¼šè¿”å›žä¸€ä¸ªç±»åž‹ä¸º `Result` çš„å€¼ã€‚

`Result` æ˜¯ä¸€ç§**æžšä¸¾ç±»åž‹**ï¼Œé€šå¸¸ä¹Ÿå†™ä½œ **enum**ï¼Œå®ƒå¯ä»¥æ˜¯å¤šç§å¯èƒ½çŠ¶æ€ä¸­çš„ä¸€ä¸ªã€‚
æˆ‘ä»¬æŠŠæ¯ç§å¯èƒ½çš„çŠ¶æ€ç§°ä¸ºä¸€ç§ **æžšä¸¾æˆå‘˜ï¼ˆvariantï¼‰**ã€‚

`Result` çš„æˆå‘˜æ˜¯ `Ok` å’Œ `Err`ï¼Œ`Ok` æˆå‘˜è¡¨ç¤ºæ“ä½œæˆåŠŸï¼Œå†…éƒ¨åŒ…å«**æˆåŠŸæ—¶äº§ç”Ÿçš„å€¼**ã€‚
`Err` æˆå‘˜åˆ™æ„å‘³ç€æ“ä½œå¤±è´¥ï¼Œå¹¶ä¸” Err ä¸­åŒ…å«**æœ‰å…³æ“ä½œå¤±è´¥çš„åŽŸå› æˆ–æ–¹å¼çš„ä¿¡æ¯**ã€‚

`Result` çš„å®žä¾‹æ‹¥æœ‰ `expect` æ–¹æ³•ã€‚
å¦‚æžœ `io::Result` å®žä¾‹çš„å€¼æ˜¯ `Err`ï¼Œ`expect` ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œå¹¶è¾“å‡º**å½“åšå‚æ•°ä¼ é€’ç»™ `expect` çš„ä¿¡æ¯**ã€‚
æ‰€ä»¥å½“ `read_line` æ–¹æ³•è¿”å›ž `Err`ï¼Œåˆ™å¯èƒ½æ˜¯æ¥æºäºŽåº•å±‚æ“ä½œç³»ç»Ÿé”™è¯¯çš„ç»“æžœã€‚

å¦‚æžœ `Result` å®žä¾‹çš„å€¼æ˜¯ `Ok`ï¼Œ`expect` ä¼šèŽ·å– `Ok` ä¸­çš„å€¼å¹¶åŽŸæ ·è¿”å›žã€‚
åœ¨æœ¬ä¾‹ä¸­ï¼Œè¿™ä¸ªå€¼æ˜¯ç”¨æˆ·è¾“å…¥åˆ°æ ‡å‡†è¾“å…¥ä¸­çš„å­—èŠ‚æ•°ã€‚

å¦‚æžœä¸è°ƒç”¨ `expect`ï¼Œç¨‹åºä¹Ÿèƒ½ç¼–è¯‘ï¼Œä¸è¿‡ä¼šå‡ºçŽ°ä¸€ä¸ªè­¦å‘Šï¼š

```bash
$ cargo build
   Compiling guessing_game v0.1.0 (file:///projects/guessing_game)
warning: unused `Result` that must be used
  --> src/main.rs:10:5
   |
10 |     io::stdin().read_line(&mut guess);
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: this `Result` may be an `Err` variant, which should be handled
   = note: `#[warn(unused_must_use)]` on by default
help: use `let _ = ...` to ignore the resulting value
   |
10 |     let _ = io::stdin().read_line(&mut guess);
   |     +++++++

warning: `guessing_game` (bin "guessing_game") generated 1 warning
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.59s

```

 > è­¦å‘Šæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ read_line çš„è¿”å›žå€¼ Resultï¼Œè¯´æ˜Žæœ‰ä¸€ä¸ªå¯èƒ½çš„é”™è¯¯æ²¡æœ‰å¤„ç†ã€‚
 > æ¶ˆé™¤è­¦å‘Šçš„æ­£ç¡®åšæ³•æ˜¯å®žé™…åŽ»**ç¼–å†™é”™è¯¯å¤„ç†ä»£ç **ï¼Œä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±æ˜¯å¸Œæœ›ç¨‹åºåœ¨å‡ºçŽ°é—®é¢˜æ—¶**ç«‹å³å´©æºƒ**ï¼Œæ‰€ä»¥ç›´æŽ¥ä½¿ç”¨ `expect`ã€‚

```rust
println!("You guessed: {guess}");
```

`{}` è¿™å¯¹å¤§æ‹¬å·æ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚
å½“æ‰“å°**å˜é‡çš„å€¼**æ—¶ï¼Œå˜é‡åå¯ä»¥å†™è¿›å¤§æ‹¬å·ä¸­ã€‚

å½“æ‰“å°**è¡¨è¾¾å¼çš„æ‰§è¡Œç»“æžœ**æ—¶ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆformat stringï¼‰ä¸­å¤§æ‹¬å·ä¸­ç•™ç©ºï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²åŽè·Ÿé€—å·åˆ†éš”çš„éœ€è¦æ‰“å°çš„è¡¨è¾¾å¼åˆ—è¡¨ï¼Œå…¶é¡ºåºä¸Žæ¯ä¸€ä¸ªç©ºå¤§æ‹¬å·å ä½ç¬¦çš„é¡ºåºä¸€è‡´ã€‚å³ï¼š

```rust
let x = 5;
let y = 10;

println!("x = {x} and y + 2 = {}", y + 2);
```

# ç”Ÿæˆç§˜å¯†æ•°å­—

æŽ¥ä¸‹æ¥ï¼Œéœ€è¦ç”Ÿæˆä¸€ä¸ªç§˜å¯†æ•°å­—ï¼Œå¥½è®©ç”¨æˆ·æ¥çŒœã€‚
ç§˜å¯†æ•°å­—åº”è¯¥æ¯æ¬¡éƒ½ä¸åŒï¼Œè¿™æ ·é‡å¤çŽ©æ‰ä¸ä¼šä¹å‘³ï¼›
èŒƒå›´åº”è¯¥åœ¨ 1 åˆ° 100 ä¹‹é—´ï¼Œè¿™æ ·æ‰ä¸ä¼šå¤ªå›°éš¾ã€‚

Rust æ ‡å‡†åº“ä¸­å°šæœªåŒ…å«éšæœºæ•°åŠŸèƒ½ã€‚
ç„¶è€Œï¼ŒRust å›¢é˜Ÿè¿˜æ˜¯æä¾›äº†ä¸€ä¸ªåŒ…å«ä¸Šè¿°åŠŸèƒ½çš„ `rand` crateã€‚

> crate æ˜¯ä¸€ç»„ Rust **æºä»£ç æ–‡ä»¶**ã€‚
> æˆ‘ä»¬æ­£åœ¨æž„å»ºçš„é¡¹ç›®æ˜¯ä¸€ä¸ª äºŒè¿›åˆ¶ crateï¼Œå®ƒç”Ÿæˆä¸€ä¸ª**å¯æ‰§è¡Œæ–‡ä»¶**ã€‚
> `rand` crate æ˜¯ä¸€ä¸ª **åº“ crate**ï¼Œ**åº“ crate** å¯ä»¥åŒ…å«ä»»æ„èƒ½è¢«å…¶ä»–ç¨‹åºä½¿ç”¨çš„ä»£ç ï¼Œä½†æ˜¯æ— æ³•ç‹¬ç«‹æ‰§è¡Œã€‚
>
> [Crates.io](https://crates.io/) æ˜¯ Rust ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œäººä»¬å‘å¸ƒå…¶å¼€æº Rust é¡¹ç›®çš„å¹³å°ï¼Œä¾›ä»–äººä½¿ç”¨ã€‚

æ‰‹åŠ¨åœ¨`Cargo.toml`æ–‡ä»¶ä¸­å¢žåŠ ï¼š

```toml
[dependencies]
rand = "0.8.5"
```

ä»£ç ï¼š

```rust
use std::io;

use rand::Rng;

fn main() {
    println!("Guess the number!");

    let secret_number = rand::thread_rng().gen_range(1..=100);

    println!("The secret number is: {secret_number}");

    println!("Please input your guess.");

    let mut guess = String::new();

    io::stdin()
        .read_line(&mut guess)
        .expect("Failed to read line");

    println!("You guessed: {guess}");
}
```

> æ–°å¢žäº†ä¸€è¡Œ `use rand::Rng;`ã€‚
> `Rng` æ˜¯ä¸€ä¸ª traitï¼Œå®ƒå®šä¹‰äº†éšæœºæ•°ç”Ÿæˆå™¨åº”å®žçŽ°çš„æ–¹æ³•ï¼Œæƒ³ä½¿ç”¨è¿™äº›æ–¹æ³•çš„è¯ï¼Œæ­¤ trait å¿…é¡»åœ¨ä½œç”¨åŸŸä¸­ã€‚

`rand::thread_rng` **å‡½æ•°**æä¾›å®žé™…ä½¿ç”¨çš„**éšæœºæ•°ç”Ÿæˆå™¨**ï¼šå®ƒä½äºŽ**å½“å‰æ‰§è¡Œçº¿ç¨‹**çš„æœ¬åœ°çŽ¯å¢ƒä¸­ï¼Œå¹¶ä»Žæ“ä½œç³»ç»ŸèŽ·å– seedã€‚

æŽ¥ç€è°ƒç”¨éšæœºæ•°ç”Ÿæˆå™¨çš„ `gen_range` æ–¹æ³•ã€‚
è¿™ä¸ªæ–¹æ³•ç”± `use rand::Rng` è¯­å¥å¼•å…¥åˆ°ä½œç”¨åŸŸçš„ `Rng` **trait** å®šä¹‰ã€‚

`gen_range` æ–¹æ³•èŽ·å–ä¸€ä¸ª**èŒƒå›´è¡¨è¾¾å¼ï¼ˆrange expressionï¼‰** ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåœ¨æ­¤èŒƒå›´ä¹‹é—´çš„éšæœºæ•°ã€‚
è¿™é‡Œä½¿ç”¨çš„è¿™ç±»èŒƒå›´è¡¨è¾¾å¼ä½¿ç”¨äº† `start..=end` è¿™æ ·çš„å½¢å¼ï¼Œå®ƒå¯¹ä¸Šä¸‹è¾¹ç•Œå‡ä¸ºé—­åŒºé—´ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®š `1..=100` æ¥è¯·æ±‚ä¸€ä¸ª 1 å’Œ 100 ä¹‹é—´çš„æ•°ã€‚

> **æ³¨æ„**ï¼šä½ ä¸å¯èƒ½å‡­ç©ºå°±çŸ¥é“åº”è¯¥ `use` å“ªä¸ª trait ä»¥åŠè¯¥ä»Ž crate ä¸­è°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œå› æ­¤æ¯ä¸ª crate æœ‰ä½¿ç”¨è¯´æ˜Žæ–‡æ¡£ã€‚

> Cargo çš„å¦ä¸€ä¸ªå¾ˆæ£’çš„åŠŸèƒ½æ˜¯è¿è¡Œ `cargo doc --open` å‘½ä»¤æ¥æž„å»ºæ‰€æœ‰æœ¬åœ°ä¾èµ–æä¾›çš„æ–‡æ¡£å¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ã€‚
> ä¾‹å¦‚ï¼Œå‡è®¾ä½ å¯¹ `rand` crate ä¸­çš„å…¶ä»–åŠŸèƒ½æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥è¿è¡Œ `cargo doc --open` å¹¶ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ ä¸­çš„ `rand`ã€‚

# æ¯”è¾ƒçŒœæµ‹æ•°å­—å’Œç§˜å¯†æ•°å­—

ä»£ç ï¼š

```rust
// æš‚æ—¶è¿˜ä¸èƒ½ç¼–è¯‘
use std::cmp::Ordering;
use std::io;

use rand::Rng;

fn main() {
    // --snip--

    println!("You guessed: {guess}");

    match guess.cmp(&secret_number) {
        Ordering::Less => println!("Too small!"),
        Ordering::Greater => println!("Too big!"),
        Ordering::Equal => println!("You win!"),
    }
}
```

ä»Žæ ‡å‡†åº“å¼•å…¥äº†ä¸€ä¸ªå«åš `std::cmp::Ordering` çš„ç±»åž‹åˆ°ä½œç”¨åŸŸä¸­ã€‚

`Ordering` ä¹Ÿæ˜¯ä¸€ä¸ª**æžšä¸¾ç±»åž‹**:
- `Less`
- `Greater`
- `Equal`

è¿™æ˜¯æ¯”è¾ƒä¸¤ä¸ªå€¼æ—¶å¯èƒ½å‡ºçŽ°çš„ä¸‰ç§ç»“æžœã€‚

```rust
match guess.cmp(&secret_number) {
	Ordering::Less => println!("Too small!"),
	Ordering::Greater => println!("Too big!"),
	Ordering::Equal => println!("You win!"),
}
```

ä¸€ä¸ª `match` è¡¨è¾¾å¼ç”± **åˆ†æ”¯ï¼ˆarmsï¼‰** æž„æˆã€‚
ä¸€ä¸ªåˆ†æ”¯åŒ…å«ä¸€ä¸ª **æ¨¡å¼ï¼ˆpatternï¼‰** å’Œ â€œå½“è¡¨è¾¾å¼å¼€å¤´çš„å€¼ä¸Žåˆ†æ”¯æ¨¡å¼ç›¸åŒ¹é…â€ æ—¶åº”è¯¥æ‰§è¡Œçš„ä»£ç ã€‚

Rust èŽ·å–æä¾›ç»™ `match` çš„å€¼å¹¶æŒ¨ä¸ªæ£€æŸ¥æ¯ä¸ªåˆ†æ”¯çš„æ¨¡å¼ã€‚
`match` ç»“æž„å’Œæ¨¡å¼æ˜¯ Rust ä¸­å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒä½“çŽ°äº†ä»£ç å¯èƒ½é‡åˆ°çš„å¤šç§æƒ…å½¢ï¼Œå¹¶ç¡®ä¿å¯¹æ‰€æœ‰æƒ…å†µä½œå‡ºå¤„ç†ã€‚

`let guess = String::new()` ä¸­Rust æŽ¨æ–­å‡º `guess` åº”è¯¥æ˜¯ `String` ç±»åž‹ã€‚
å¦ä¸€æ–¹é¢ï¼Œ`secret_number`ï¼Œæ˜¯æ•°å­—ç±»åž‹ã€‚
è¿™é‡Œçš„ç¼–è¯‘é”™è¯¯çš„åŽŸå› åœ¨äºŽ Rust ä¸ä¼šæ¯”è¾ƒå­—ç¬¦ä¸²ç±»åž‹å’Œæ•°å­—ç±»åž‹ã€‚

```rust
let mut guess = String::new();

io::stdin()
	.read_line(&mut guess)
	.expect("Failed to read line");

let guess: u32 = guess.trim().parse().expect("Please type a number!");

println!("You guessed: {guess}");

match guess.cmp(&secret_number) {
	Ordering::Less => println!("Too small!"),
	Ordering::Greater => println!("Too big!"),
	Ordering::Equal => println!("You win!"),
}
```

Rust å…è®¸ç”¨ä¸€ä¸ªæ–°å€¼æ¥ **é®è”½ ï¼ˆShadowingï¼‰** `guess` ä¹‹å‰çš„å€¼ã€‚
è¿™ä¸ªåŠŸèƒ½ç»å¸¸ç”¨äºŽ ***å°†ä¸€ä¸ªç±»åž‹çš„å€¼è½¬æ¢ä¸ºå¦ä¸€ä¸ªç±»åž‹çš„å€¼***ã€‚

```rust
let guess: u32 = guess.trim().parse().expect("Please type a number!");
```

`String` å®žä¾‹çš„ `trim` æ–¹æ³•ä¼šåŽ»é™¤å­—ç¬¦ä¸²å¼€å¤´å’Œç»“å°¾çš„ç©ºç™½å­—ç¬¦ã€‚

ç”¨æˆ·å¿…é¡»è¾“å…¥ `enter` é”®æ‰èƒ½è®© `read_line` è¿”å›žå¹¶è¾“å…¥ä»–ä»¬çš„çŒœæƒ³ï¼Œè¿™å°†ä¼šåœ¨å­—ç¬¦ä¸²ä¸­å¢žåŠ ä¸€ä¸ªæ¢è¡Œï¼ˆnewlineï¼‰ç¬¦ã€‚
ä¾‹å¦‚ï¼Œç”¨æˆ·è¾“å…¥ 5 å¹¶æŒ‰ä¸‹ `enter`ï¼Œguess çœ‹èµ·æ¥åƒè¿™æ ·ï¼š`5\n` æˆ–è€… `5\r\n`ã€‚
`trim` æ–¹æ³•ä¼šæ¶ˆé™¤ `\n` æˆ–è€… `\r\n`ï¼Œç»“æžœåªç•™ä¸‹ 5ã€‚

**å­—ç¬¦ä¸²**çš„ `parse` æ–¹æ³• å°†å­—ç¬¦ä¸²è½¬æ¢æˆ**å…¶ä»–ç±»åž‹**ã€‚
æˆ‘ä»¬éœ€è¦å‘Šè¯‰ Rust å…·ä½“çš„æ•°å­—ç±»åž‹ï¼Œè¿™é‡Œé€šè¿‡ `let guess: u32` æŒ‡å®šã€‚

`parse` æ–¹æ³•éžå¸¸å®¹æ˜“å‡ºé”™ã€‚
ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²ä¸­åŒ…å« `AðŸ‘%`ï¼Œå°±æ— æ³•å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—ã€‚
å› æ­¤ï¼Œ`parse` æ–¹æ³•è¿”å›žä¸€ä¸ª `Result` ç±»åž‹ã€‚

ç”¨ `expect` æ–¹æ³•å¤„ç† `Result`ã€‚
- å¦‚æžœ `parse` ä¸èƒ½ä»Žå­—ç¬¦ä¸²ç”Ÿæˆä¸€ä¸ªæ•°å­—ï¼Œè¿”å›žä¸€ä¸ª `Result` çš„ `Err` æˆå‘˜æ—¶ï¼Œ`expect` ä¼šä½¿æ¸¸æˆå´©æºƒå¹¶æ‰“å°é™„å¸¦çš„ä¿¡æ¯ã€‚
- å¦‚æžœ `parse` æˆåŠŸåœ°å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå®ƒä¼šè¿”å›ž `Result` çš„ `Ok` æˆå‘˜ï¼Œç„¶åŽ `expect` ä¼šè¿”å›ž `Ok` å€¼ä¸­çš„æ•°å­—ã€‚

# ä½¿ç”¨å¾ªçŽ¯å…è®¸å¤šæ¬¡çŒœæµ‹

ä»£ç ï¼š

```rust
use std::cmp::Ordering;
use std::io;

use rand::Rng;

fn main() {
    println!("Guess the number!");
    let secret_number = rand::thread_rng().gen_range(1..=100);
    println!("The secret number is: {secret_number}");
    loop {
        println!("Please input your guess");
        let mut guess = String::new();
        io::stdin()
            .read_line(&mut guess)
            .expect("Failed to read line");
        println!("You guessed: {guess}");
        let guess: u32 = guess.trim().parse().expect("Please type a number!");
        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                println!("You win!");
                break;
            }
        }
    }
}
```

# å¤„ç†æ— æ•ˆè¾“å…¥

ä»£ç ï¼š

```rust
// --snip--

io::stdin()
	.read_line(&mut guess)
	.expect("Failed to read line");

let guess: u32 = match guess.trim().parse() {
	Ok(num) => num,
	Err(_) => continue,
};

println!("You guessed: {guess}");

// --snip--
```

å°† `expect` è°ƒç”¨æ¢æˆ `match` è¯­å¥ï¼Œä»¥ä»Žé‡åˆ°é”™è¯¯å°±å´©æºƒè½¬æ¢ä¸ºå¤„ç†é”™è¯¯ã€‚
å¦‚æžœ `parse` èƒ½å¤ŸæˆåŠŸåœ°å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå®ƒä¼šè¿”å›žä¸€ä¸ªåŒ…å«ç»“æžœæ•°å­—çš„ `Ok`ã€‚

è¿™ä¸ª `Ok` å€¼ä¸Ž `match` ç¬¬ä¸€ä¸ªåˆ†æ”¯çš„æ¨¡å¼ç›¸åŒ¹é…ï¼Œè¯¥åˆ†æ”¯å¯¹åº”çš„åŠ¨ä½œè¿”å›ž Ok å€¼ä¸­çš„æ•°å­— `num`ï¼Œæœ€åŽå¦‚æ„¿å˜æˆæ–°åˆ›å»ºçš„ `guess` å˜é‡ã€‚

å¦‚æžœ `parse` ä¸èƒ½å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå®ƒä¼šè¿”å›žä¸€ä¸ªåŒ…å«æ›´å¤šé”™è¯¯ä¿¡æ¯çš„ `Err`ã€‚
`Err` å€¼ä¸èƒ½åŒ¹é…ç¬¬ä¸€ä¸ª `match` `Ok(num)` æ¨¡å¼ï¼Œä½†æ˜¯ä¼šåŒ¹é…ç¬¬äºŒä¸ªåˆ†æ”¯çš„ `Err(_)` æ¨¡å¼ï¼š`_` æ˜¯ä¸€ä¸ªé€šé…ç¬¦å€¼ï¼Œæœ¬ä¾‹ä¸­ç”¨æ¥åŒ¹é…æ‰€æœ‰ `Err` å€¼ï¼Œä¸ç®¡å…¶ä¸­æœ‰ä½•ç§ä¿¡æ¯ã€‚
æ‰€ä»¥ç¨‹åºä¼šæ‰§è¡Œç¬¬äºŒä¸ªåˆ†æ”¯çš„åŠ¨ä½œï¼Œ`continue` æ„å‘³ç€è¿›å…¥ `loop` çš„ä¸‹ä¸€æ¬¡å¾ªçŽ¯ï¼Œè¯·æ±‚å¦ä¸€ä¸ªçŒœæµ‹ã€‚

# æœ€ç»ˆä»£ç 

```rust
use std::cmp::Ordering;
use std::io;

use rand::Rng;

fn main() {
    println!("Guess the number!");

    let secret_number = rand::thread_rng().gen_range(1..=100);

    loop {
        println!("Please input your guess");

        let mut guess = String::new();

        io::stdin()
            .read_line(&mut guess)
            .expect("Failed to read line");

        println!("You guessed: {guess}");

        let guess: u32 = match guess.trim().parse() {
            Ok(num) => num,
            Err(_) => {
                println!("Please type a number!");
                continue;
            }
        };

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                println!("You win!");
                break;
            }
        }
    }
}
```